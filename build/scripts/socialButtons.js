!function(t){"use strict";function e(){this.uniqueName=null,this.script=null,this.data=null}t.SocialButtons=function(t){this.options=l.extend({},[n,t]),this._shareOptions=this._createShareOptions(),this._storageButtons={},this._lastShareUrl="",this._renderComponents=this._createRenderComponents(),this._containerDOM=document.createElement("div"),this._containerDOM.className="container-social-buttons",this.options.services&&this.options.services.length>0&&this._begin()},SocialButtons.prototype._begin=function(){var t=this,e=this.options.services.length,n=0,o=this.options.id;o in i||(i[o]=!0,this.options.services.forEach(function(o){o in r&&t._createHTML(r[o]).then(function(r){t._storageButtons[o]=r,++n===e&&t._renderHTML()})}))},SocialButtons.prototype._createHTML=function(t){var e=this,n=e.options.helpers[t.name],o=n.customClass||"",r=l.createElement("div","b-social-button b-social-button--"+t.name+" b-social-button--"+e.options.theme+" "+o,{title:n.title}),i=e._getButtonsSize(this.options.buttonSize);i&&(r.style.fontSize=i+"px");var s=l.createElement("div","social-button__components");if(r.appendChild(s),!0===e._renderComponents.icon){var u=l.createElement("div","social-button__icon");s.appendChild(u)}if(!0===e._renderComponents.text){var a=l.createElement("div","social-button__text");a.innerHTML=n.text,s.appendChild(a)}if(r.addEventListener("click",function(){e._openPopup(t),e._countIncrement(r,{name:t.name,url:e._lastShareUrl})}),(e.options.counter&&null!=t.getCountUrl||null!=n.counter)&&e._renderComponents.count){var c=l.createElement("div","social-button__count");return e._getCounter(t,n.counter).then(function(t){return c.setAttribute("data-count",t),""===(t=function(t,e,n){t||e||(t=""),"function"==typeof n&&(t=n(isNaN(parseInt(t))?0:parseInt(t)));return t}(t,e.options.showZeros,e.options.outputCountCallback))&&(c.className+=" social-button__count--empty"),c.innerHTML=t,s.appendChild(c),r})}return Promise.resolve(r)},SocialButtons.prototype._renderHTML=function(){var t=this,e=document.querySelector("#"+this.options.id);if(e){this.options.services.forEach(function(e){if(e in t._storageButtons){var n=t._storageButtons[e];t._containerDOM.appendChild(n)}}),e.appendChild(this._containerDOM);var n=t.options.callbacks.create;"function"==typeof n&&n({self:e,options:t.options})}else console.error("#"+this.options.id,"not found!")},SocialButtons.prototype._getButtonsSize=function(t){switch(t){case"small":t=22;break;case"middle":t=28;break;case"large":t=34;break;default:var e=parseFloat(t);isNaN(e)||(t=e)}return t},SocialButtons.prototype._getCounter=function(t,e){var n=this.options.url,o=s.caching[n];return null!=o?Promise.resolve(o):null!=e&&"function"==typeof e?Promise.resolve(e()):s.get(t,n).then(function(t){return s.caching[n]=t,t})},SocialButtons.prototype._parseTemplate=function(t,e){if(!t)return"";return t.replace(/{{[^{{]+}}/gi,function(t){var n=(t=t.replace(/\s+/g,"")).split("").filter(function(t,e,n){if(e>1&&n.length-2>e)return!0}).join("");return n in e?encodeURIComponent(e[n]):""})},SocialButtons.prototype._openPopup=function(t){var e=this._parseTemplate(t.shareUrl,this._shareOptions);this._lastShareUrl=e,window.open(e,"share","toolbar=0,status=0,scrollbars=0,width=600,height=450")},SocialButtons.prototype._countIncrement=function(t,e){var n,o=t.querySelector(".social-button__count");if(null!=o&&(n=o.getAttribute("data-count"),n++,!isNaN(n))){o.setAttribute("data-count",n);var r=this.options.outputCountCallback;"function"==typeof r&&(n=r(n)),o.innerHTML=n;var i=this.options.callbacks.share;"function"==typeof i&&i({self:t,service:e})}},SocialButtons.prototype._createRenderComponents=function(){var t={icon:!1,text:!1,count:!1};for(var e in t)t.hasOwnProperty(e)&&this.options.components.indexOf(e)>=0&&(t[e]=!0);return t},SocialButtons.prototype._createShareOptions=function(){var t={url:document.querySelector('[property="og:url"]'),title:document.querySelector('[property="og:title"]'),description:document.querySelector('[property="og:description"]'),image:document.querySelector('[property="og:image"]')};for(var e in t)t.hasOwnProperty(e)&&t[e]&&(t[e]=t[e].getAttribute("content"));return{url:this.options.url||t.url||window.location.href,title:this.options.title||t.title||document.title,description:this.options.description||t.description||"",image:this.options.image||t.image||""}};var n={components:["icon","text","count"],theme:"default",callbacks:{create:null,share:null},outputCountCallback:null,helpers:{vkontakte:{text:"Рассказать",title:"Рассказать в Вконтакте",customClass:"",counter:null},facebook:{text:"Поделиться",title:"Поделиться в Facebook",customClass:"",counter:null},googleplus:{text:"Это интересно",title:"Это интересно Google Plus",customClass:"",counter:null},odnoklassniki:{text:"Написать",title:"Написать в Одноклассниках",customClass:"",counter:null},moimir:{text:"Поделиться",title:"Поделиться ссылкой в Мой Мир",customClass:"",counter:null},twitter:{text:"Ретвит",title:"Написать в Twitter",customClass:"",counter:null},lj:{text:"Написать",title:"Разместить запись в LiveJournal",customClass:"",counter:null},linkedin:{text:"Поделиться",title:"Поделиться в Linkedin",customClass:"",counter:null}}},o="https:"===location.protocol?"https":"http",r={vkontakte:{name:"vkontakte",promises:[],shareUrl:o+"://vk.com/share.php?url={{ url }}&title={{ title }}&description={{ description }}&image={{ image }}",getCountUrl:o+"://vk.com/share.php?act=count&url=",counter:function(n,o){var i=new e,s=this.promises.length;i.create(this.getCountUrl+n+"&index="+s),this.promises.push(o),t.VK||(t.VK={}),window.VK.Share={count:function(t,e){r.vkontakte.promises[t].resolve(e)}}}},facebook:{name:"facebook",shareUrl:o+"://www.facebook.com/sharer/sharer.php?u={{ url }}&title={{ title }}&description={{ description }}&image={{ image }}",getCountUrl:o+"://graph.facebook.com/?id=",counter:function(t,n){(new e).create(this.getCountUrl+t).then(function(t){var e=0;null!=t.share&&null!=t.share.share_count&&(e=t.share.share_count),n.resolve(e)})}},googleplus:{name:"googleplus",shareUrl:o+"://plus.google.com/share?url={{ url }}",getCountUrl:o+"://share.yandex.ru/gpp.xml?url=",counter:function(t,n){(new e).create(this.getCountUrl+t).then(function(t){null==t&&(t=0),n.resolve(t)})}},odnoklassniki:{name:"odnoklassniki",promises:[],shareUrl:o+"://www.odnoklassniki.ru/dk?st.cmd=addShare&st.s=1&st._surl={{ url }}&st.comments={{ title }}",getCountUrl:o+"://connect.ok.ru/dk?st.cmd=extLike&ref=",counter:function(n,o){var i=new e,s=this.promises.length;i.create(this.getCountUrl+n+"&uid="+s),this.promises.push(o),t.ODKL||(t.ODKL={}),t.ODKL.updateCount=function(t,e){r.odnoklassniki.promises[t].resolve(e)}}},moimir:{name:"moimir",shareUrl:o+"://connect.mail.ru/share?url={{ url }}&title={{ title }}&description={{ description  }}",getCountUrl:o+"://appsmail.ru/share/count/",counter:function(t,n){var o=t.indexOf("//");t=t.slice(o+2);(new e).create(this.getCountUrl+t).then(function(t){var e=t.share_mm;null==e&&(e=0),n.resolve(e)})}},twitter:{name:"twitter",shareUrl:o+"://twitter.com/share?={{ url }}&text={{ description }}",getCountUrl:null,counter:function(t,e){e.resolve(0)}},lj:{name:"lj",shareUrl:o+"://www.livejournal.com/update.bml?subject={{ title }}&event={{ description }}",getCountUrl:null,counter:function(t,e){e.resolve(0)}},linkedin:{name:"linkedin",shareUrl:o+"://www.linkedin.com/shareArticle?mini=true&url={{ url }}&title={{ title }}&summary={{ description }}",getCountUrl:null,counter:function(t,e){e.resolve(0)}}},i={},s={caching:{},get:function(t,e){var n=l.deferred();return t.counter(e,n),n.promise}};e.prototype.create=function(e){var n=this,o=l.deferred(),r=e.indexOf("?")>0?"&":"?";return this.uniqueName="f_"+String(Math.random()).slice(2),this.script=document.createElement("script"),this.script.src=e+r+"callback="+this.uniqueName,document.head.appendChild(this.script),t[this.uniqueName]=function(t){n.data=t},n.script.onload=function(){n.remove(),o.resolve(n.data)},n.script.onerror=function(){n.remove(),o.resolve(null)},o.promise},e.prototype.remove=function(){delete t[this.uniqueName],this.script.parentNode.removeChild(this.script)};var l={deferred:function(){var t={};return t.promise=new Promise(function(e,n){t.resolve=e,t.reject=n}),t},extend:function(t,e){function n(t,e){for(var o in e)if(e.hasOwnProperty(o)){var r=e[o];"Object"===l.getConstructor(r)?(t[o]||(t[o]={}),n(t[o],r)):t[o]=r}}for(var o in e)e.hasOwnProperty(o)&&n(t,e[o]);return t},createElement:function(t,e,n){var o=document.createElement(t);if(e&&(o.className=e),n)for(var r in n)if(n.hasOwnProperty(r)){var i=n[r];o.setAttribute(r,i)}return o},getConstructor:function(t){return Object.prototype.toString.call(t).slice(8,-1)}}}(window);
